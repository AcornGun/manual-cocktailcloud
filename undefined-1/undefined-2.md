# 서비스 노출

클러스터 내부와 외부에서 워크로드가 제공하는 서비스 기능을 호출하기 위해서 각각 클러스터 IP 방식과 노드 포트 방식의 서비스를 정의합니다.

클라우드에 클러스터를 구성한 상태에서 노드 포트 방식으로 서비스를 정의한 경우, 그 앞단에 로드 밸런서를 구성하여 외부에서 로드 밸런서 주소와 포트를 통해 서비스를 호출하게 할 수도 있습니다.

## 어떤 서비스 노출 유형을 지원하나요?

* 클러스터 IP
* 노드 포트
* 로드 밸런서

## 서비스 노출의 특장점은 무엇인가요?

### 손쉬운 서비스 생성

웹 UI 컨솔 상에서 손쉽게 각각의 서비스 노출 유형을 생성할 수 있습니다.

### 로드밸런서 자동 생성

퍼블릭 클라우드에서 클러스터를 구성했을 경우 경우, 칵테일 클라우드가 로드벨런서를 자동 생성해 줍니다. 로드벨러서 유형의 서비스 노출은 AWS, Azure, GCP 같이 지원하는 클라우드에서만 가능합니다.

## 태스크 목록

* 서비스 생성
* 서비스 조회
* 인그레스 생성
* 인그레스 조회

## 1. 서비스 생성

### 1.1 서비스 노출 화면 접근

서비스 맵의 서비스 노출 화면에서 우측 상단 "+생성" 버튼을 클릭합니다.

![\[&#xD654;&#xBA74;\] &#xC11C;&#xBE44;&#xC2A4; &#xB9F5; - &#xC11C;&#xBE44;&#xC2A4; &#xB178;&#xCD9C;](../.gitbook/assets/2020-10-14-5.30.05.png)

### 1.2 서비스 노출 유형 선택

![\[&#xD654;&#xBA74;\] &#xC11C;&#xBE44;&#xC2A4; &#xB178;&#xCD9C; &#xC720;&#xD615; &#xC120;&#xD0DD;](../.gitbook/assets/2020-10-14-5.31.14.png)

### 1.3 서비스 노출 기본 정보 입력

서비스 노출 명 및 라벨 정보를 입력합니다. "라벨 선택기"를 클릭하여 워크로드에 미리 설정되어 있는 라벨을 선택할 수도 있습니다. 미리 설정되어 있는 라벨을 선택하는 경우가 아닌 경우에는, 라벨 이름과 값의 쌍을 입력할 수 있습니다.

![\[&#xD654;&#xBA74;\] &#xC6CC;&#xD06C;&#xB85C;&#xB4DC;&#xC5D0; &#xC124;&#xC815;&#xB418;&#xC5B4; &#xC788;&#xB294; &#xB77C;&#xBCA8;&#xC744; &#xC120;&#xD0DD;&#xD558;&#xC5EC; &#xC11C;&#xBE44;&#xC2A4; &#xB77C;&#xBCA8;&#xB85C; &#xCD94;&#xAC00;](../.gitbook/assets/2020-10-14-5.39.18.png)

![\[&#xD654;&#xBA74;\] &#xC11C;&#xBE44;&#xC2A4;&#xC5D0; &#xC774;&#xB984;-&#xAC12;&#xC73C;&#xB85C; &#xAD6C;&#xC131;&#xB41C; &#xB77C;&#xBCA8; &#xC815;&#xBCF4;&#xB97C; &#xC785;&#xB825;](../.gitbook/assets/2020-10-14-5.38.16.png)

### 1.4 서비스 대상 포트 설정

서비스에 의해 노출되는 포트를 추가합니다.

![\[&#xD654;&#xBA74;\] &#xC6CC;&#xD06C;&#xB85C;&#xB4DC;&#xC5D0; &#xC124;&#xC815;&#xB418;&#xC5B4; &#xC788;&#xB294; &#xAE30;&#xC874; &#xB77C;&#xBCA8;&#xC744; &#xC120;&#xD0DD;&#xD558;&#xC5EC; &#xC11C;&#xBE44;&#xC2A4; &#xB77C;&#xBCA8;&#xB85C; &#xC785;&#xB825;](../.gitbook/assets/2020-10-14-5.50.35.png)

![\[&#xD654;&#xBA74;\] &#xC11C;&#xBE44;&#xC2A4; &#xB300;&#xC0C1; &#xD3EC;&#xD2B8; &#xC124;&#xC815;](../.gitbook/assets/2020-10-14-5.51.35.png)

### 1.5 저장

설정 정보 입력 후 생성된 서비스를 실제 생성시키기 위해서는 반드시 저장 버튼을 클릭하도록 합니다.

## 2. 서비스 조회

서비스 맵의 서비스 노출 화면에서 생성된 서비스 정보를 조회합니다.

### 2.1 서비스 목록 조회

서비스 맵의 서비스 노출 화면에서 서비스 목록을 조회합니다.

![\[&#xD654;&#xBA74;\] &#xC11C;&#xBE44;&#xC2A4; &#xBAA9;&#xB85D; &#xC870;&#xD68C;](../.gitbook/assets/2020-10-14-6.00.05.png)

### 2.2 서비스 상세 정보 조회

서비스 목록에 표시된 서비스 이름 링크를 클릭합니다. 서비스의 설정 정보 및 상태 정보가 표시됩니다.

![\[&#xD654;&#xBA74;\] &#xC11C;&#xBE44;&#xC2A4; &#xC124;&#xC815; &#xC815;&#xBCF4; &#xBC0F; &#xC0C1;&#xD0DC; &#xC815;&#xBCF4;](../.gitbook/assets/2020-10-14-6.11.27.png)

서비스 설정 정보 및 상태 정보를 YAML 형식으로 조회할 수도 있습니다. 상기 화면 우측 상단의 설정 버튼을 클릭한 후 표시되는 화면에서 죄측 상단의 설정 보기를 "YAML 보기"로 선택하면 YAML 형식의 정보가 표시됩니다.

![\[&#xD654;&#xBA74;\] &#xC11C;&#xBE44;&#xC2A4; &#xC124;&#xC815; &#xBC0F; &#xC0C1;&#xD0DC; &#xC815;&#xBCF4;&#xC758; YAML &#xD615;&#xC2DD; &#xC870;&#xD68C;](../.gitbook/assets/2020-10-14-6.14.38.png)

## 3. 인그레스 생성

인그레스는 클러스터 외부로부터 클러스터 내부 서비스로의 HTTP/HTTPS 라우팅을 제어할 수 있게 해 주는 기능입니다. 인그레스를 생성하기 위해서는 칵테일 클라우드의 애드온 관리 화면을 통해 해당 클러스터에 사전에 인그레스 컨트롤러를 설치해 놓아야 합니다. 

### 3.1 인그레스 화면 접근

서비스 맵의 인그레스 화면에서 우측 상단 "+생성" 버튼을 클릭합니다.

![\[&#xD654;&#xBA74;\] &#xC11C;&#xBE44;&#xC2A4; &#xB9F5;&#xC758; &#xC778;&#xADF8;&#xB808;&#xC2A4; &#xD654;&#xBA74;](../.gitbook/assets/2020-10-14-6.17.32.png)

### 3.2 인그레스 기본 정보 입력

인그레스 이름을 입력하고 미리 클러스터에 설치해 놓은 인그레스 컨트롤러를 선택하는 등, 인그레스의 기본 정보를 입력합니다.

![\[&#xD654;&#xBA74;\] &#xC778;&#xADF8;&#xB808;&#xC2A4; &#xAE30;&#xBCF8; &#xC815;&#xBCF4; &#xC785;&#xB825; &#xD654;&#xBA74;](../.gitbook/assets/2020-10-14-6.18.19.png)

### 3.3 인그레스 규칙 입력

인그레스 규칙을 적용할 호스트 정보를 설정하고, 해당 호스트에 대한 인커밍 요청에 대한 벡엔드 서비스로의 라우팅 규칙을 설정합니다.

![\[&#xD654;&#xBA74;\] &#xC778;&#xADF8;&#xB808;&#xC2A4; &#xADDC;&#xCE59; &#xC124;&#xC815; &#xD654;&#xBA74;](../.gitbook/assets/2020-10-14-6.26.03.png)

### 3.4 인그레스 TLS 입력

인그레스와 관련된 TLS \(전송 계층 보안\) 관련 정보를 설정합니다. 443 포트에서 TLS 트래픽을 종료하기 위해 사용되는 시크릿 정보 및 TLS 인증서에 포함되는 호스트 정보를 입력합니다.

![\[&#xD654;&#xBA74;\] &#xC778;&#xADF8;&#xB808;&#xC2A4; TLS &#xC124;&#xC815;](../.gitbook/assets/2020-10-14-6.26.47.png)

### 3.5 저장

인그레스를 실제 생성시키기 위해서는 반드시 저장 버튼을 클릭하도록 합니다.

## 4. 인그레스 조회

서비스 맵의 인그레스 화면에서 생성된 인그레스 정보를 조회합니다.

### 4.1 인그레스 목록 조회

서비스 맵의 인그레스 화면에서 인그레스 목록을 조회합니다.

![\[&#xD654;&#xBA74;\] &#xC778;&#xADF8;&#xB808;&#xC2A4; &#xBAA9;&#xB85D; &#xC870;&#xD68C; &#xD654;&#xBA74;](../.gitbook/assets/2020-10-14-6.30.17.png)

### 4.2 인그레스 상세 정보 조회

인그레스 목록에 표시된 인그레스 이름 링크를 클릭합니다. 인그레스의 설정 정보 및 상태 정보가 표시됩니다.

![\[&#xD654;&#xBA74;\] &#xC778;&#xADF8;&#xB808;&#xC2A4; &#xC0C1;&#xC138; &#xC815;&#xBCF4; &#xC870;&#xD68C; &#xD654;&#xBA74;](../.gitbook/assets/2020-10-14-6.29.22.png)

인그레스 설정 정보 및 상태 정보를 YAML 형식으로 조회할 수도 있습니다. 상기 화면 우측 상단의 설정 버튼을 클릭한 후 표시되는 화면에서 죄측 상단의 설정 보기를 "YAML 보기"로 선택하면 YAML 형식의 정보가 표시됩니다.

![\[&#xD654;&#xBA74;\] &#xC778;&#xADF8;&#xB808;&#xC2A4; &#xC124;&#xC815; &#xBC0F; &#xC0C1;&#xD0DC; &#xC815;&#xBCF4;&#xC758; YAML &#xD615;&#xC2DD; &#xC870;&#xD68C;](../.gitbook/assets/2020-10-14-6.31.10.png)

## 

